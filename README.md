# KNUE WWW Short URL

한국교원대학교 게시판용 단축 URL 생성기

---

## 소개

- 본 프로젝트는 **KNUE(한국교원대학교) 공식 홈페이지의 공지사항·게시글 등 긴 URL을 짧고 관리하기 쉽게 변환**하는 웹 유틸리티입니다.
- [Sqids](https://github.com/sqids/sqids-javascript) 라이브러리를 활용하여, 게시글 번호 등 주요 파라미터를 안전하게 인코딩/디코딩합니다.
- 데이터베이스 등 별도의 서버 없이 **클라이언트에서 즉시 인코딩/디코딩 및 리다이렉트**가 가능합니다.
- 현재는 API 서버처럼 동작하며, URL 파라미터에 따라 JSON 응답을 반환하거나 특정 조건에서 리다이렉트를 수행합니다.

---

## 주요 특징

### 🔗 URL 단축 기능

- **긴 게시판 URL → 짧은 단축 URL** 변환
- 원본 파라미터(site, key, bbsNo, nttNo)만 포함, 예측 어려운 랜덤 문자열
- 별도의 서버 저장 없이 인코딩 값만으로 원본 URL 완전 복원

### 🔒 보안 강화

- **Content Security Policy (CSP)**: XSS 공격 방지를 위한 엄격한 보안 정책
- **도메인 검증**: KNUE 도메인(`https://www.knue.ac.kr/`)으로만 리다이렉트 허용
- **입력 유효성 검사**: 모든 파라미터에 대한 타입 및 범위 검증
- **전역 오류 처리**: 예상치 못한 오류 상황에 대한 안전한 처리

### ⚡ 성능 최적화

- **Sqids 최적화**: 확장된 66자 알파벳으로 더 짧은 코드 생성
- **최소 길이 보장**: 3자리 이상의 일관된 단축 코드
- **효율적인 사이트 매핑**: 36개 KNUE 서브도메인을 숫자로 압축

### 🛠 개발자 친화적

- **TypeScript 스타일 JSDoc**: 상세한 타입 정보와 사용 예시
- **포괄적인 테스트**: Vitest 기반의 단위 및 통합 테스트
- **모듈화된 구조**: 기능별로 분리된 깔끔한 파일 구조

---

## 프로젝트 구조

```
. (프로젝트 루트)
├── src/
│   ├── js/                    # JavaScript 파일들
│   │   ├── urlEncoder.js      # 핵심 인코딩/디코딩 로직 (Sqids 기반)
│   │   ├── app.js             # 클라이언트 애플리케이션 진입점
│   │   └── knueSites.js       # KNUE 사이트 매핑 (36개 서브도메인)
│   └── styles/                # CSS 파일들
│       └── main.css           # 메인 스타일시트
├── test/
│   ├── index.test.js          # 핵심 인코딩/디코딩 로직 테스트
│   └── main.test.js           # 클라이언트 애플리케이션 로직 테스트
├── index.html                 # 메인 HTML (보안 헤더 포함)
├── package.json               # 프로젝트 의존성 및 스크립트
├── vite.config.js             # Vite 빌드 및 Vitest 테스트 설정
├── CLAUDE.md                  # Claude Code 작업 가이드
└── README.md                  # 프로젝트 설명 (현재 파일)
```

---

## 개발 환경 설정 및 실행

이 프로젝트는 `npm`을 통한 의존성 관리와 `Vite`를 통한 개발 및 빌드를 사용합니다.

### 의존성 설치

프로젝트 루트에서 다음 명령어를 실행하여 필요한 의존성을 설치합니다.

```bash
npm install
```

### 개발 서버 실행

개발 중에는 다음 명령어를 사용하여 로컬 개발 서버를 실행할 수 있습니다. 코드를 변경하면 자동으로 새로고침됩니다.

```bash
npm run dev
```

### 프로젝트 빌드

배포를 위해 프로젝트를 빌드하려면 다음 명령어를 실행합니다. 최적화된 정적 파일들이 `dist` 디렉토리에 생성됩니다.

```bash
npm run build
```

### 테스트 실행

인코딩/디코딩 로직 및 클라이언트 사이드 동작을 테스트하려면 다음 명령어를 실행합니다.

```bash
npm test
```

---

## 사용 방법

이 애플리케이션은 URL 파라미터에 따라 세 가지 모드로 동작합니다:

### 1. 인코딩 모드 (단축 URL 생성)

긴 KNUE 게시판 URL의 파라미터를 단축 코드로 변환하고 QR 코드를 생성합니다.

**URL 형식:**

```
https://www.knue.ac.kr/s/?site={사이트}&key={키}&bbsNo={게시판번호}&nttNo={게시글번호}
```

**예시:**

```
https://www.knue.ac.kr/s/?site=www&key=12345&bbsNo=678&nttNo=9012
```

**결과:**

- 단축된 URL 표시 (예: `https://www.knue.ac.kr/s/?AbC123`)
- QR 코드 자동 생성
- 클릭하면 클립보드에 복사

### 2. 디코딩 모드 (원본 URL로 리다이렉트)

단축 코드를 원본 KNUE URL로 복원하여 자동 리다이렉트합니다.

**URL 형식:**

```
https://www.knue.ac.kr/s/?{단축코드}
```

**예시:**

```
https://www.knue.ac.kr/s/?AbC123
```

**동작:**

- ✅ 성공 시: `https://www.knue.ac.kr/www/selectBbsNttView.do?key=12345&bbsNo=678&nttNo=9012`로 리다이렉트
- ❌ 실패 시: "잘못된 주소입니다" 알림 후 홈페이지로 리다이렉트

---

## 배포 및 운영

### 정적 사이트 배포

이 애플리케이션은 완전한 클라이언트 사이드 애플리케이션으로, 다음 플랫폼에 쉽게 배포할 수 있습니다:

- **Vercel**: `npm run build` 후 `dist` 폴더 배포
- **Netlify**: Git 연동으로 자동 빌드/배포
- **GitHub Pages**: Actions를 통한 자동 배포
- **기타 정적 호스팅**: CloudFlare Pages, AWS S3 등

### 보안 고려사항

- **CSP 설정**: 모든 외부 스크립트/스타일 차단으로 XSS 방지
- **도메인 제한**: KNUE 도메인으로만 리다이렉트 허용
- **HTTPS 필수**: 프로덕션 환경에서는 반드시 HTTPS 사용 권장

### 모니터링

전역 오류 처리가 구현되어 있어 콘솔에서 오류 추적이 가능합니다. 프로덕션 환경에서는 Sentry 등의 오류 추적 서비스 연동을 권장합니다.

---

## 기술 스택

- **프론트엔드**: Vanilla JavaScript (ES6+)
- **빌드 도구**: Vite
- **테스트**: Vitest + jsdom
- **URL 인코딩**: Sqids
- **QR 코드**: qrcode.js
- **스타일**: CSS3 + Pretendard 폰트

---

## 기여

이 프로젝트에 기여하고 싶으시다면, 언제든지 이슈를 등록하거나 Pull Request를 보내주세요.

### 개발 가이드라인

1. **코드 스타일**: ESLint 규칙 준수
2. **테스트**: 새로운 기능은 반드시 테스트 코드 포함
3. **보안**: 모든 입력값 검증 및 XSS 방지 고려
4. **문서화**: JSDoc 형식의 상세한 주석 작성

### 라이선스

ISC License
